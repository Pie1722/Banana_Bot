# Banana_Bot
Telegram bot to which you can chat and have a great time. Using the API of GROQ, LLAMA AI is used to give a responce to the text.

The bot is being run in the console of python anywhere.

# How To Use
Start the bot by using /start command. This command also allows the bot to clear its memory for the particular user.

Then start chatting with the bot. It can help you with mathematics, programming etc, in short it works as meta AI of Whatsapp but for telegram.

Limitation it has is that it cannot generate images.

If you want to run the code in your server then you can use pythonanywhere's console. 

To use pythonanywhere:
1. Upload the code to your file directory in your account.
2. Install the required libraries
3. Run the code in console using command: python code_file.py or if it is not working try running it with specific python like: python3.10 code_file.py

```python

from telegram import Update
from telegram.ext import Application, CommandHandler, MessageHandler, ContextTypes, filters
import requests
import os # To access environment variables like token and API key.
from dotenv import load_dotenv

load_dotenv() # Loads .env file and puts the variables into os.environ

TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN")
GROQ_API = os.getenv("GROQ_API")

# Memory dictionary for users. It is not defined so for unlimited users.
user_memory = {}
MEMORY_LIMIT = 100  #Keeps chat history trimmed to the last 100 turns

#Takes a list of chat messages, sends them to Groq's LLaMA3 model, and returns the response
def query_llama(messages: list) -> str: # the responce should be in a list and it should be string
    url = "https://api.groq.com/openai/v1/chat/completions"  #API endpoint
    headers = {
        "Authorization": f"Bearer {GROQ_API}",
        "Content-Type": "application/json"
    }
    data = {
        "model": "llama3-8b-8192",
        "messages": messages,
        #"max_tokens": 300,
        "temperature": 1.2
    }

    try:
        response = requests.post(url, headers=headers, json=data, timeout=30)
        response.raise_for_status()
        return response.json()["choices"][0]["message"]["content"]
    except Exception as e:
        return f"Groq/LLaMA Error: {str(e)}" # returns error message if generated by the API

# async def defines a coroutine, which is a special type of function that can pause (yield control) while waiting for something,
# allowing other tasks to run in the meantime
async def start_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    user_memory[user_id] = []  # clear memory on /start
    await update.message.reply_text("Zeep Morp Beep!")

async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    user_message = update.message.text

    # Initialize memory if new user
    if user_id not in user_memory:
        user_memory[user_id] = []

    # Add user's message
    user_memory[user_id].append({"role": "user", "content": user_message})
    user_memory[user_id] = user_memory[user_id][-MEMORY_LIMIT:]

    # Get reply from model
    reply = query_llama(user_memory[user_id])

    # Add bot's reply to memory
    user_memory[user_id].append({"role": "assistant", "content": reply})
    user_memory[user_id] = user_memory[user_id][-MEMORY_LIMIT:]

    await update.message.reply_text(reply)

async def handle_sticker(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("ðŸ’©")

async def handle_photo(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text("I cannot understand pictures!")

def main():
    app = Application.builder().token(TELEGRAM_TOKEN).build()

    app.add_handler(CommandHandler("start", start_command))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))
    app.add_handler(MessageHandler(filters.Sticker.ALL, handle_sticker))
    app.add_handler(MessageHandler(filters.PHOTO, handle_photo))

    print("Banana is running!")
    app.run_polling()

# it is used so that it is not used as an import in another file
# only main() can also be used
if __name__ == "__main__":
    main()

```


<a href="https://t.me/Banana_2025_bot" target="_blank">
  <img src="https://github.com/Pie1722/Banana_Bot/blob/main/logo.png" alt="Bot" width="70" height="70">
</a>

[@banana_2025_bot](https://t.me/Banana_2025_bot)

